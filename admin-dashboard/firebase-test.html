<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase Network Test</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .log { margin: 10px 0; padding: 10px; border-radius: 4px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
        .info { background: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>Firebase Network Diagnostics</h1>
    <div id="logs"></div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.5.0/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js';
        import { getFirestore, doc, getDoc } from 'https://www.gstatic.com/firebasejs/10.5.0/firebase-firestore.js';

        const logsContainer = document.getElementById('logs');
        
        function log(message, type = 'info') {
            const div = document.createElement('div');
            div.className = `log ${type}`;
            div.textContent = `${new Date().toLocaleTimeString()}: ${message}`;
            logsContainer.appendChild(div);
            console.log(message);
        }

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDCbl4Zr7nco51NJ7fRafyBOh23-2qtOD4",
            authDomain: "visitaproject-5cd9f.firebaseapp.com",
            projectId: "visitaproject-5cd9f",
            storageBucket: "visitaproject-5cd9f.firebasestorage.app",
            messagingSenderId: "490423265288",
            appId: "1:490423265288:web:eee490e89f588ff9bfc9bd"
        };

        try {
            log('Initializing Firebase...', 'info');
            const app = initializeApp(firebaseConfig);
            log('Firebase app initialized successfully', 'success');

            const auth = getAuth(app);
            log('Firebase Auth initialized', 'success');

            const db = getFirestore(app);
            log('Firestore initialized', 'success');

            // Monitor network requests
            const originalFetch = window.fetch;
            window.fetch = function(...args) {
                log(`Network request: ${args[0]}`, 'info');
                return originalFetch.apply(this, args)
                    .then(response => {
                        if (!response.ok) {
                            log(`Network error: ${response.status} - ${response.statusText}`, 'error');
                        } else {
                            log(`Network success: ${response.status}`, 'success');
                        }
                        return response;
                    })
                    .catch(error => {
                        log(`Network failure: ${error.message}`, 'error');
                        throw error;
                    });
            };

            // Test authentication
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    log(`User authenticated: ${user.email}`, 'success');
                } else {
                    log('No user authenticated', 'info');
                }
            });

            // Test with a sample authentication (replace with actual test credentials)
            log('Testing authentication...', 'info');
            
        } catch (error) {
            log(`Firebase initialization error: ${error.message}`, 'error');
        }
    </script>
</body>
</html>